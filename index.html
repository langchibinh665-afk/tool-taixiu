<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<title>Tool T√†i X·ªâu - B√åNH</title>
<title>c·ªù b·∫°c kh√¥ng gi√∫p ta ƒë·ªïi ƒë·ªùi,n√≥ ch·ªâ gi√∫p ƒë·ªïi s·ªë d∆∞ tk</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>
  body{background:#0d011a;color:#e5e1ea;font-family:Arial,sans-serif;padding:18px;text-align:center;}
  h1{color:#e6dfed;text-shadow:0 0 12px #080110;margin-bottom:6px;}
  .box{background:#150022;border:2px solid #080113;padding:18px;border-radius:12px;max-width:520px;margin:12px auto;box-shadow:0 0 25px #060011;}
  input{width:86%;padding:10px;border-radius:8px;border:2px solid #b5abc2;background:#1b0030;color:#eae8ee;margin:8px 0;display:block;margin-left:auto;margin-right:auto;}
  .btns{display:flex;justify-content:center;gap:14px;margin-top:12px;}
  button{padding:10px 16px;border-radius:8px;border:0;background:#040009;color:#fff;cursor:pointer;box-shadow:0 0 12px #fffeff;flex:1;max-width:160px;}
  button:hover{background:#b17dff;}
  #result{margin-top:18px;font-size:34px;font-weight:700;text-shadow:0 0 8px #bca0bc;min-height:56px;display:flex;align-items:center;justify-content:center;}
  #result.tai{ color:#e3ebeb; text-shadow:0 0 8px #b2e4e0,0 0 20px #a6d3cf; }
  #result.xiu{ color:#190219; text-shadow:0 0 8px #fdffffff,0 0 20px #f5f0f5ff; }
  #keyTimer{margin-top:8px;color:#dcd0ff;font-size:14px;}
  .small{font-size:13px;color:#e8d8ff;margin-top:6px;}
</style>
</head>

<body>

<!-- üîä NH·∫†C N·ªÄN (TH√äM) -->
<audio id="bgMusic" loop preload="auto">
  <source src="music.mp3" type="audio/mpeg">
</audio>

<h1>Tool T√†i X·ªâu - B√åNH</h1>
<h1>c·ªù b·∫°c kh√¥ng gi√∫p ta ƒë·ªïi ƒë·ªùi,n√≥ ch·ªâ gi√∫p ƒë·ªïi s·ªë d∆∞ tk</h1>

<!-- KEY -->
<div id="keyBox" class="box">
  <h3>Nh·∫≠p key</h3>
  <input id="keyInput" placeholder="Nh·∫≠p key..." autocomplete="off" />
  <div class="btns">
    <button onclick="checkKey()">X√°c th·ª±c</button>
  </div>
  <p id="keyMsg" class="small"></p>
</div>

<!-- MAIN TOOL -->
<div id="mainTool" class="box" style="display:none;">
  <h3>Ph√¢n t√≠ch t·ª´ MD5</h3>
  <input id="md5Input" placeholder="D√°n chu·ªói MD5 " autocomplete="off"/>
  <div class="btns">
    <button onclick="runAnalyze()">Ph√¢n T√≠ch</button>
  </div>

  <div id="keyTimer" aria-live="polite"></div>
  <div id="result" aria-live="polite"></div>
  <p class="small">Ch√∫ √Ω: tool ch·ªâ l√† c√¥ng c·ª• tham kh·∫£o .</p>
</div>

<script>
/*
  C∆° ch·∫ø key:
  - KEY_LIST: danh s√°ch key m·∫´u (client-side). B·∫°n c√≥ th·ªÉ b·ªï sung key ·ªü ƒë√¢y.
  - Khi user nh·∫≠p key v√† X√°c th·ª±c:
      + N·∫øu key h·ª£p l·ªá v√† ch∆∞a b·ªã ƒë√°nh d·∫•u 'used', t·∫°o access l∆∞u local: {key, expiresAt}
      + B·∫Øt ƒë·∫ßu ƒë·∫øm ng∆∞·ª£c th·ªùi gian hi·ªÉn th·ªã
  - Khi th·ªùi gian h·∫øt:
      + X√≥a access, ƒë√°nh d·∫•u key v√†o used_keys (localStorage) => key kh√¥ng d√πng l·∫°i ƒë∆∞·ª£c
      + return user v·ªÅ m√†n nh·∫≠p key
  - N·∫øu user reload trang trong th·ªùi gian active: access ƒë∆∞·ª£c restore v√† ƒë·∫øm ti·∫øp.
  - N·∫øu user x√≥a localStorage: s·∫Ω reset (gi·ªõi h·∫°n c·ªßa ph∆∞∆°ng ph√°p local-only)
*/

// ======== Danh s√°ch key (client demo) =======
const KEY_LIST = {
  "BINHVIPPRO": 10000000000,
  "bumanh":1000,
};

// localStorage keys
const LS_ACCESS = 'tool_access_multi_v2';
const LS_USED = 'tool_used_keys_v2';

// ======== Key functions ========
function getUsedKeys(){
  try { return JSON.parse(localStorage.getItem(LS_USED) || '[]'); } catch(e){ return []; }
}
function markKeyUsed(key){
  const arr = getUsedKeys();
  if(!arr.includes(key)) arr.push(key);
  localStorage.setItem(LS_USED, JSON.stringify(arr));
}
function isKeyUsed(key){
  const arr = getUsedKeys();
  return arr.includes(key);
}

// ======== Check key (validate) ========
function checkKey(){
  const k = document.getElementById('keyInput').value.trim();
  const msg = document.getElementById('keyMsg');
  msg.textContent = '';
  if(!k){ msg.textContent = 'Nh·∫≠p key tr∆∞·ªõc.'; return; }

  if(isKeyUsed(k)){
    msg.textContent = 'Key n√†y ƒë√£ b·ªã s·ª≠ d·ª•ng tr∆∞·ªõc ƒë√≥. Kh√¥ng th·ªÉ d√πng l·∫°i.';
    return;
  }

  if(!KEY_LIST[k]){
    msg.textContent = 'Key kh√¥ng h·ª£p l·ªá.';
    return;
  }

  const mins = Number(KEY_LIST[k]) || 60;
  const expiresAt = Date.now() + mins * 60 * 1000;
  const access = { key: k, expiresAt };
  localStorage.setItem(LS_ACCESS, JSON.stringify(access));

  document.getElementById('keyBox').style.display = 'none';
  document.getElementById('mainTool').style.display = 'block';
  document.getElementById('keyMsg').textContent = 'ƒê√£ x√°c th·ª±c. Tool s·∫µn s√†ng.';
  startKeyTimer();
}

// ======== Restore access on load ========
function restoreAccess(){
  try{
    const raw = localStorage.getItem(LS_ACCESS);
    if(!raw) return false;
    const acc = JSON.parse(raw);
    if(!acc || !acc.key || !acc.expiresAt) return false;
    if(isKeyUsed(acc.key)) { localStorage.removeItem(LS_ACCESS); return false; }
    if(Date.now() >= acc.expiresAt){
      markKeyUsed(acc.key);
      localStorage.removeItem(LS_ACCESS);
      return false;
    }
    document.getElementById('keyBox').style.display = 'none';
    document.getElementById('mainTool').style.display = 'block';
    document.getElementById('keyMsg').textContent = 'ƒê√£ ƒëƒÉng nh·∫≠p (l∆∞u tr√™n thi·∫øt b·ªã).';
    startKeyTimer();
    return true;
  } catch(e){ return false; }
}

// ======== Key countdown ========
let keyTimerInterval = null;
function startKeyTimer(){
  clearInterval(keyTimerInterval);
  keyTimerInterval = setInterval(()=>{
    const raw = localStorage.getItem(LS_ACCESS);
    const timerEl = document.getElementById('keyTimer');
    if(!raw){ timerEl.textContent = ''; clearInterval(keyTimerInterval); return; }
    const acc = JSON.parse(raw);
    const remain = acc.expiresAt - Date.now();
    if(remain <= 0){
      markKeyUsed(acc.key);
      localStorage.removeItem(LS_ACCESS);
      clearInterval(keyTimerInterval);
      document.getElementById('mainTool').style.display = 'none';
      document.getElementById('keyBox').style.display = 'block';
      document.getElementById('keyMsg').textContent = 'Key ƒë√£ h·∫øt h·∫°n.';
      timerEl.textContent = '';
      document.getElementById('result').innerHTML = '';
      return;
    }
    const mm = Math.floor(remain / 60000);
    const ss = Math.floor((remain % 60000) / 1000);
    timerEl.textContent = `time key : ${mm} ph√∫t ${ss} gi√¢y`;
  }, 1000);
}

// ======== Analysis functions ========
function isMD5(s){ return /^[a-fA-F0-9]{32}$/.test(s); }
function hexPairToDec(pair){ return parseInt(pair,16); }

function algoHexSum(md5){
  const s = md5.slice(0,8);
  let sum = 0;
  for(let i=0;i<8;i+=2){
    sum += hexPairToDec(s.slice(i,i+2));
  }
  const percent = sum % 100;
  const vote = (sum % 2 === 0) ? 'Tai' : 'Xiu';
  return { percent, vote };
}

function algoDelta(md5){
  let A=0,B=0;
  for(let i=0;i<md5.length;i++){
    const code = md5.charCodeAt(i);
    if(i%2===0) A += code; else B += code;
  }
  const delta = Math.abs(A-B);
  let percent;
  if(delta < 50) percent = 18 + Math.floor(delta*0.4);
  else if(delta < 120) percent = 40 + Math.floor((delta-50)*0.285);
  else percent = Math.min(95, 61 + Math.floor((delta-120)*0.08));
  percent = Math.max(0, Math.min(100, percent));
  const vote = percent >= 50 ? 'Tai' : 'Xiu';
  return { percent, vote };
}

function algoReverseBlocks(md5){
  const rev = md5.split('').reverse().join('');
  let sumBlocks = 0;
  for(let i=0;i<32;i+=4){
    const blk = rev.slice(i,i+4);
    sumBlocks += parseInt(blk,16) || 0;
  }
  const percent = sumBlocks % 100;
  const vote = percent >= 50 ? 'Tai' : 'Xiu';
  return { percent, vote };
}

function aiVote(md5){
  const a1 = algoHexSum(md5);
  const a2 = algoDelta(md5);
  const a3 = algoReverseBlocks(md5);
  const avgPercent = Math.round((a1.percent + a2.percent + a3.percent) / 3);
  const taiVotes = [a1.vote,a2.vote,a3.vote].filter(v=>v==='Tai').length;
  const final = taiVotes >= 2 ? 'Tai' : 'Xiu';
  return { final, percent: avgPercent };
}

function runAnalyze(){
  const md5raw = document.getElementById('md5Input').value.trim().toLowerCase();
  const resultEl = document.getElementById('result');
  resultEl.className = '';
  resultEl.textContent = '';
  if(!isMD5(md5raw)){
    resultEl.textContent = '‚ùå MD5 kh√¥ng h·ª£p l·ªá';
    return;
  }
  const out = aiVote(md5raw);
  if(out.final === 'Tai'){
    resultEl.className = 'tai';
    resultEl.innerHTML = `üéØ <strong>T√ÄI</strong> (${out.percent}%)`;
  } else {
    resultEl.className = 'xiu';
    resultEl.innerHTML = `üîÆ <strong>X·ªàU</strong> (${100 - out.percent}%)`;
  }
}

function clearAll(){
  document.getElementById('md5Input').value = '';
  document.getElementById('result').textContent = '';
}

window.addEventListener('load', ()=>{
  const restored = restoreAccess();
  if(!restored){
    document.getElementById('keyBox').style.display = 'block';
    document.getElementById('mainTool').style.display = 'none';
  }
});

/* üîä K√çCH HO·∫†T NH·∫†C TR√äN MOBILE (TH√äM) */
function startMusic() {
  const music = document.getElementById('bgMusic');
  music.volume = 0.6;
  music.play().catch(()=>{});
  document.removeEventListener('click', startMusic);
}
document.addEventListener('click', startMusic);
</script>

</body>
</html>
